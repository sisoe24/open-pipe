stages:
  - test

run-tests:
  tags:
    - pipeline
  stage: test
  script:
    # Be sure we have a python3.7, install it with conda
    - conda create -n m74-tests python==3.7 --yes
    - conda activate m74-tests
    # Install poetry
    - pip install poetry
    - poetry --version
    - poetry env info
    # Install the dependencies of the tests
    - poetry install -vv
    # Finally, run the tests!
    - ./run_tests.sh
  only:
    - merge_requests
